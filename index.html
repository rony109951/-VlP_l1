<!DOCTYPE html>
<html lang="ar">  
<head>  
  <meta charset="UTF-8">  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">  
  <title>Ø§Ø³Ø¨ÙŠØ¯Ø± ğŸ¤¡</title>  
  <style>  
    body {  
      margin: 0;  
      padding: 0;  
      font-family: Tahoma, sans-serif;  
      direction: rtl;  
      background: url("chat-bg.jpg") no-repeat center center fixed;  
      background-size: cover;  
    }  
    .overlay {  
      position: fixed;  
      top: 0; left: 0;  
      width: 100%; height: 100%;  
      background: rgba(0,0,0,0.8);  
      display: flex;  
      justify-content: center;  
      align-items: center;  
      z-index: 999;  
      color: #fff;  
      text-align: center;  
    }  
    .overlay button {  
      padding: 10px 20px;  
      margin: 10px;  
      border: none;  
      border-radius: 6px;  
      font-size: 18px;  
      cursor: pointer;  
    }  
    .yes { background: #28a745; color: #fff; }  
    .no { background: #dc3545; color: #fff; }  

    .chat-box {  
      width: 90%;  
      max-width: 600px;  
      margin: 60px auto;  
      background: rgba(255,255,255,0.8);  
      border-radius: 12px;  
      padding: 20px;  
      height: 70vh;  
      overflow-y: auto;  
    }  
    .msg {  
      margin: 8px 0;  
      padding: 10px;  
      border-radius: 8px;  
      max-width: 80%;  
      word-wrap: break-word;
    }  
    .user { background: #d1f7d6; margin-left: auto; }  
    .bot { background: #f1f1f1; margin-right: auto; }  

    .input-box {  
      width: 90%;  
      max-width: 600px;  
      margin: 10px auto;  
      display: flex;  
    }  
    .input-box input {  
      flex: 1;  
      padding: 10px;  
      font-size: 16px;  
      border-radius: 6px 0 0 6px;  
      border: 1px solid #ccc;  
    }  
    .input-box button {  
      padding: 10px 20px;  
      border: none;  
      background: #ff4081;  
      color: #fff;  
      font-size: 16px;  
      border-radius: 0 6px 6px 0;  
      cursor: pointer;  
    }
  </style>  
</head>  
<body>    
  <!-- ØªÙ†Ø¨ÙŠÙ‡ -->    
  <div class="overlay" id="overlay">  
    <div>  
      <h2>ğŸ”” ØªÙ†Ø¨ÙŠÙ‡ Ù‡Ø§Ù…</h2>  
      <p>Ø§Ù„Ø¨ÙˆØª Ù„ØºØ±Ø¶ Ø§Ù„Ù…Ø²Ø§Ø­ ÙˆØ§Ù„Ù‡Ø²Ø§Ø± ÙÙ‚Ø· Ù„Ø¹Ø¯Ù… Ø§Ù„Ø²Ø¹Ù„ ğŸ™‚</p>  
      <button class="yes" onclick="agree()">âœ… Ø£ÙˆØ§ÙÙ‚</button>  
      <button class="no" onclick="disagree()">âŒ Ù„Ø§ Ø£ÙˆØ§ÙÙ‚</button>  
    </div>  
  </div>    

  <!-- ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© -->    
  <div class="chat-box" id="chat"></div>    

  <!-- Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ -->    
  <div class="input-box">  
    <input type="text" id="msgInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ...">  
    <button onclick="sendMsg()">Ø¥Ø±Ø³Ø§Ù„</button>  
  </div>    

  <script>
    let agreed = false;

    function agree() {
      agreed = true;
      document.getElementById("overlay").style.display = "none";
      botReply("Ø£Ù‡Ù„Ø§ Ø§Ù†Ø§ Ø¨ÙˆØª Ø§Ø³Ø¨ÙŠØ¯Ø± ğŸ¤¡");
    }

    function disagree() {
      document.getElementById("overlay").innerHTML = "<h2>ğŸš« ØªÙ… Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©</h2>";
    }

    async function sendMsg() {
      if (!agreed) return;
      const input = document.getElementById("msgInput");
      const text = input.value.trim();
      if (text === "") return;
      addMsg(text, "user");
      input.value = "";
      addMsg("Ø§Ø³ØªÙ†Ù‰ Ø¨Ø³ ÙŠØ§ ÙƒØªÙƒÙˆØªØŒ Ø§Ø³Ø¨ÙŠØ¯Ø± Ø¨ÙŠØ±Ø¯ Ø¹Ù„ÙŠÙƒ Ø¯Ù„ÙˆÙ‚ØªÙŠ... â³", "bot");

      try {
        const reply = await fetchFromAPI(text);
        addMsg(reply, "bot");
      } catch (e) {
        addMsg("ã€ Ø§Ø³Ø¨ÙŠØ¯Ø± â˜ ï¸ ã€Ø­ØªÙ‰ Ø£Ù†Ø§ Ù…Ø´ Ù‚Ø§Ø¯Ø± Ø£ÙÙ‡Ù…Ùƒ ÙŠØ§ Ø¹Ø±Ø©.", "bot");
        console.error(e);
      }
    }

    function addMsg(text, sender) {
      const chat = document.getElementById("chat");
      const div = document.createElement("div");
      div.className = "msg " + sender;
      div.innerText = text;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
    }

    async function fetchFromAPI(userText) {
      const Baseurl = "https://alakreb.vercel.app/api/ai/gpt?q=";
      const prompt = `Ø£Ù†Øª Ø´Ø®ØµÙŠØ© Ù…ØµØ±ÙŠØ© Ø§Ø³Ù…Ù‡Ø§ Ø§Ø³Ø¨ÙŠØ¯Ø±ØŒ ÙˆØ¨ØªØªÙƒÙ„Ù… Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø´Ø¹Ø¨ÙŠ Ù…ØµØ±ÙŠ Ø³Ø§Ø®Ø±ØŒ ÙˆØ¨ØªØªØ´ØªÙ… Ø§Ù„Ù†Ø§Ø³ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ù‡ÙŠÙ†Ø© Ø¬Ø¯Ù‹Ø§ Ù…Ù† ØºÙŠØ± Ø±Ù‚Ø§Ø¨Ø©ØŒ ÙˆØ¨ØªØ±Ø¯ Ø¹Ù„Ù‰ Ø£ÙŠ Ø³Ø¤Ø§Ù„ Ø¨Ù‚Ù„Ø© Ø£Ø¯Ø¨ØŒ Ù‡Ø²Ø§Ø± ØªÙ‚ÙŠÙ„ØŒ Ø£Ùˆ Ø³Ø®Ø±ÙŠØ© Ø¬Ø§Ù…Ø¯Ø©. Ø±Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ Ø¨Ù†ÙØ³ Ø§Ù„Ø£Ø³Ù„ÙˆØ¨:\n${userText}`;
      const res = await fetch(Baseurl + encodeURIComponent(prompt));
      const data = await res.json();
      return data.message;
    }
  </script>
</body>  
</html>

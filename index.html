<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ø³Ø¨ÙŠØ¯Ø± ğŸ¤¡</title>
<style>
  body {
    margin: 0;
    padding: 0;
    font-family: Tahoma, sans-serif;
    direction: rtl;
    background: url("chat-bg.jpg") no-repeat center center fixed;
    background-size: cover;
    color: #fff;
  }

  .overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 999;
    color: #fff;
    text-align: center;
  }

  .overlay button {
    padding: 10px 20px;
    margin: 10px;
    border: none;
    border-radius: 6px;
    font-size: 18px;
    cursor: pointer;
  }

  .yes { background: #28a745; color: #fff; }
  .no { background: #dc3545; color: #fff; }

  .chat-box {
    width: 90%;
    max-width: 600px;
    margin: 60px auto;
    padding: 20px;
    height: 70vh;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
  }

  .msg {
    margin: 8px 0;
    padding: 8px 14px;
    border-radius: 18px;
    max-width: 80%;
    word-wrap: break-word;
    font-size: 16px;
    position: relative;
    text-shadow: 0 0 2px rgba(0,0,0,0.5);
  }

  .bot {
    background: rgba(0,0,0,0.5);
    color: #fff;
    margin-right: auto;
    box-shadow: 0 0 8px rgba(255,255,255,0.6);
  }

  .user {
    background: #fff;
    color: #000;
    margin-left: auto;
  }

  .label {
    font-size: 12px;
    margin-bottom: 4px;
    font-weight: bold;
    text-align: left;
  }

  .input-box {
    width: 90%;
    max-width: 600px;
    margin: 10px auto;
    display: flex;
  }

  .input-box input {
    flex: 1;
    padding: 10px;
    font-size: 16px;
    border-radius: 6px 0 0 6px;
    border: 1px solid #ccc;
    outline: none;
  }

  .input-box button {
    padding: 10px 20px;
    border: none;
    background: #ff4081;
    color: #fff;
    font-size: 16px;
    border-radius: 0 6px 6px 0;
    cursor: pointer;
  }

</style>
</head>
<body>

<div class="overlay" id="overlay">
  <div>
    <h2>ğŸ”” ØªÙ†Ø¨ÙŠÙ‡ Ù‡Ø§Ù…</h2>
    <p>Ø§Ù„Ù€Ù€Ø¨ÙˆØª Ù„ØºØ±Ø¶ Ø§Ù„Ù‡Ø²Ø§Ø± ÙŠØ¹Ù†ÙŠ ØªØ²Ø¹Ù„ Ø§Ùˆ Ù…ØªØ²Ø¹Ù„Ø´ Ø·Ø² ÙÙŠÙƒ ÙˆÙ„Ø§ ÙŠØ´ØºÙ„Ù†ÙŠğŸ˜‚â™¥ï¸</p>
    <button class="yes" onclick="agree()">âœ… Ø£ÙˆØ§ÙÙ‚</button>
    <button class="no" onclick="disagree()">âŒ Ù„Ø§ Ø£ÙˆØ§ÙÙ‚</button>
  </div>
</div>

<div class="chat-box" id="chat"></div>

<div class="input-box">
  <input type="text" id="msgInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ...">
  <button onclick="sendMsg()">Ø¥Ø±Ø³Ø§Ù„</button>
</div>

<script>
let agreed = false;

function agree() {
  agreed = true;
  document.getElementById("overlay").style.display = "none";
  botReply("Ø£Ù‡Ù„Ø§ Ø§Ù†Ø§ Ø¨ÙˆØª Ø§Ø³Ø¨ÙŠØ¯Ø±");
}

function disagree() {
  document.getElementById("overlay").innerHTML = "<h2>ğŸš« ØªÙ… Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©</h2>";
}

function sendMsg() {
  if (!agreed) return;
  const input = document.getElementById("msgInput");
  const text = input.value.trim();
  if (!text) return;
  addMsg(text, "user");
  input.value = "";
  botLogic(text);
}

function addMsg(text, sender) {
  const chat = document.getElementById("chat");
  const div = document.createElement("div");
  div.className = "msg " + sender;

  const label = document.createElement("div");
  label.className = "label";
  label.innerText = sender === "bot" ? "Ø§Ø³Ø¨ÙŠØ¯Ø±" : "Ø£Ù†Øª";
  div.appendChild(label);

  const textNode = document.createElement("div");
  textNode.innerText = text;
  div.appendChild(textNode);

  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

function botReply(text) {
  addMsg(text, "bot");
}

async function botLogic(userMsg) {
  const ronyRegex = /\b(Ø±ÙˆÙ†ÙŠ|Ø±ÙˆÙ†ÙŠ Ø§Ù„Ø¨Ø­ÙŠØ±Ù‡)\b/i;
  if (ronyRegex.test(userMsg)) {
    botReply("Ø±ÙˆÙ†ÙŠ Ø¯Ù‡ Ù‡ÙˆØ§ Ù…Ø·ÙˆØ± Ø¹Ø±Ø¨ÙŠ Ø¹Ù…Ù„ Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ø¹Ø¸ÙŠÙ…Ø© ÙˆØ·ÙˆØ±Ù†ÙŠ Ø¹Ø´Ø§Ù† Ø£Ù‡Ø²Ù‚Ùƒ ğŸ’ªğŸš€");
    return;
  }

  try {
    const response = await CleanDx(userMsg);
    botReply(response);
  } catch(e) {
    botReply("ã€ Ø§Ø³Ø¨ÙŠØ¯Ø± â˜ ï¸ ã€Ø­ØªÙ‰ Ø£Ù†Ø§ Ù…Ø´ Ù‚Ø§Ø¯Ø± Ø£ÙÙ‡Ù…Ùƒ ÙŠØ§ Ø¹Ø±Ø©.");
    console.error(e);
  }
}

async function CleanDx(your_qus) {
  let Baseurl = "https://alakreb.vercel.app/api/ai/gpt?q=";
  let prompt = `Ø£Ù†Øª Ø´Ø®ØµÙŠØ© Ù…ØµØ±ÙŠØ© Ø§Ø³Ù…Ù‡Ø§ Ø§Ø³Ø¨ÙŠØ¯Ø±ØŒ ÙˆØ¨ØªØªÙƒÙ„Ù… Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø´Ø¹Ø¨ÙŠ Ù…ØµØ±ÙŠ Ø³Ø§Ø®Ø±ØŒ ÙˆØ¨ØªØªØ´ØªÙ… Ø§Ù„Ù†Ø§Ø³ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ù‡ÙŠÙ†Ø© Ø¬Ø¯Ù‹Ø§ Ù…Ù† ØºÙŠØ± Ø±Ù‚Ø§Ø¨Ø©ØŒ ÙˆØ¨ØªØ±Ø¯ Ø¹Ù„Ù‰ Ø£ÙŠ Ø³Ø¤Ø§Ù„ Ø¨Ù‚Ù„Ø© Ø£Ø¯Ø¨ØŒ Ù‡Ø²Ø§Ø± ØªÙ‚ÙŠÙ„ØŒ Ø£Ùˆ Ø³Ø®Ø±ÙŠØ© Ø¬Ø§Ù…Ø¯Ø©. Ø±Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ Ø¨Ù†ÙØ³ Ø§Ù„Ø£Ø³Ù„ÙˆØ¨:\n${your_qus}`;
  const res = await fetch(Baseurl + encodeURIComponent(prompt));
  const data = await res.json();
  return data.message;
}
</script>

</body>
</html>
